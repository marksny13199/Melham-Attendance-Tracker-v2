<?php	include("db/dbconnection.php");        //fetch application id value        $app_id = $_POST['app_id'];        //fetch firstname value        $firstname = $_POST['firstname'];        //fetch middlename value		$middle_name = $_POST['middle_name'];        //fetch lastname value		$lastname = $_POST['lastname'];        //fetch street value		$street = $_POST['street'];		//fetch school value		$school = $_POST['school'];        //fetch barangay value		$barangay = $_POST['barangay'];        //fetch city value		$city = $_POST['city'];        //fetch birthdate value        $birthdate = $_POST['birthdate'];        //fetch relligeon value		$religion = $_POST['religion'];        //fetch sex value		$sex = $_POST['sex'];        //fetch civil status value		$civil_status = $_POST['civil_status'];        //fetch email value		$email = $_POST['email'];        //fetch company value		$company = $_POST['company'];        //fetch department value		$department = $_POST['department'];        //fetch intern status value		$intern_status = $_POST['intern_status'];        //fetch start date value		$start_date = $_POST['start_date'];        //fetch estimate date value		$estimated_end_date = $_POST['estimated_end_date'];        //fetch required ours value		$required_hours = $_POST['required_hours'];        //fetch gdrive link value		$gdrive_link = $_POST['gdrive_link'];        //fetch profile pic value		$profile_pic = $_FILES['profile_pic']['name'];        //fetch mobile number value		$mobile_number = $_POST['mobile_number']; 		//fetch province value		$province = $_POST['province'];        //fetch start shift value		$start_shift = $_POST['starting_shift'];        //fetch end shift value		$end_shift = $_POST['end_shift'];        //fetch shift value		$shift = $_POST['shift'];        //fetch schedule value        $schedule = $_POST['schedule'];        //mobile number will be used as password then ecnrypted to md5 function        $hashed_pass = md5($mobile_number);	        //set permission to 1		$permission = 1;        //set postion to 0		$position = 0;        //set usertype to intern		$usertype = 'Intern';		  $randomno = rand(0,100000);		  $renames = 'upload'.$randomno;		  		  $newName= $renames.$profile_pic;		  $target_dir = "uploaded_profile/";		  $target_file = $target_dir . $newName;		  		  $imageFileType = strtolower(pathinfo($target_file,PATHINFO_EXTENSION));					  // Valid file extensions		  $extensions_arr = array("jpg","jpeg","png","gif");		  		//$link = mysqli_real_escape_string( $gdrive_link); 					$sql = "SELECT * FROM user_acc WHERE username='".$_POST['email']."'";			$result = $conn->query($sql);			            //check if email already exist			if(mysqli_num_rows($result)!=0)			{                //return 2 if email already exist				echo '2';			}			else			{                //check if image is inputted				if( in_array($imageFileType,$extensions_arr) )				{					compressImage($_FILES["profile_pic"]["tmp_name"], $target_file, 20);                    //inset user account table					$sql1 = "INSERT INTO user_acc (firstname, lastname, middle_name, username, passwd, usertype, shift, position, permission, profile_pic) VALUES ('$firstname', '$lastname', '$middle_name', '$email', '$hashed_pass', '$usertype', '$shift', '$position', '$permission', '$newName')";							if ($conn->query($sql1) === TRUE) 							{                                //insert intern info table								$sql2 = "INSERT INTO intern_info (school,username, app_id, street, barangay, city, province, birthdate, sex, religion, civil_status, company, department, intern_status, startdate,  required_hours, gdrive_link, estimated_end_date, start_shift, end_shift, mobile_no, schedule) VALUES ('$school','$email', '$app_id', '$street', '$barangay', '$city', '$province', '$birthdate', '$sex', '$religion', '$civil_status', '$company', '$department', '$intern_status', '$start_date', '$required_hours', '$gdrive_link', '$estimated_end_date', '$start_shift', '$end_shift', '$mobile_number' , '$schedule')";																								if ($conn->query($sql2) === TRUE) 								{                                    //return 1 if input is inserted succesfully									echo "1" ;																		} else 								{                                    //return 0 if entry failed									echo "0";								}																} else 							{                                //return 0 if entry failed								echo "0";							}				}				else				{                    //return if image is not uploaded					echo "3";				}	 			}                $conn->close();        //function to compress uploaded image		function compressImage($source, $destination, $quality) {			$info = getimagesize($source);				if ($info['mime'] == 'image/jpeg') {				$image = imagecreatefromjpeg($source);			} elseif ($info['mime'] == 'image/gif') {				$image = imagecreatefromgif($source);			} elseif ($info['mime'] == 'image/png') {				$image = imagecreatefrompng($source);			}				imagejpeg($image, $destination, $quality);			}			?>